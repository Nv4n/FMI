<style>*{font-family: "Times new roman", sans-serif;} p {font-size: 1.08rem} span {font-size:1rem}</style>

# Проект по Системи за управление на бази от данни
    Тема: Електронни тестове
    Изготвил: Иван Петров, ф.н. 3MI0700035

## Съдържание

1. [Обхват на модела. Дефиниране на задачата.](#1-обхват-на-модела-дефиниране-на-задачата)
2. [Множества от същности и техните атрибути](#2-множества-от-същности-и-техните-атрибути)
3. [Домейн на атрибутите](#3-домейн-на-атрибутите)
4. [Връзки](#4-връзки)
5. [Ключове](#5-ключове)
6. [Правила и проверки](#6-правила-и-проверки)
7. [E/R модел на данни](#7-er-модел-на-данни)
8. [Релационен модел на данни](#8-релационен-модел-на-данни)
9. [Схема на базата от данни](#9-схема-на-базата-от-данни)
10. [Функции](#10-функции)
11. [Тригери](#11-тригери)
12. [Изгледи](#12-изгледи)
13. [Процедури](#13-процедури)
14. [Приложение за достъп до базата](#14-приложение-за-достъп-до-базата)

## 1. Обхват на модела. Дефиниране на задачата

&ensp;Базата от данни за електронни тестове, ще съхранява информация за данните в университета нужни за тестовете. Разработената база от данни ще обслужва вътрешната система на университета, т.е. няма да се обслужва уеб приложение. Университета разполага с много факултети, но създаваните тестове не зависят от факултета. Всеки тест се определя еднозначно по идентификационен номер.
&ensp;Тестовете се състоят от множество въпроси, за които се пази информация. Точките, които допринасят, когато са отговорени вярно са различни за всеки въпрос. Всеки въпрос допринася различен брой точки в различните тестове, в които участва. Въпросите се определят еднозначно от идентификационен номер. Въпросите се разделят йерархично в ООП модел на множество типове въпроси, всеки с различна характеристика.

&ensp;Типовете въпроси, добавени вече в системата, са: Есета, Затворени въпроси и Изчислителни въпроси. Всички те се определят еднозначно с идентификационния номер на въпросите, и имат условие в текстово поле. Есетата имат допълнителни характеристики за максимална и минимална дължина на есето.

&ensp;В системата се пази информация за отговорите, които еднозначно се определят от идентификационен номер и номер на въпроса за когото отговарят. В отговорите се пази информация за това дали са верен отговор на въпроса, към който сочат, както и стойността на отговора в текстов формат.

&ensp;В базата данни се съхранява информация за всички студенти от различните факултети на университета. За тях се пази тяхното име и фамилия, факултет и 	курс. Те се определят еднозначно от десетсимволния си факултетен номер.

&ensp;За всеки студент се пази информация, на коя дата се явява на определен електронен тест, както и всеки тест, който е взет в съчетание с получената от него оценка.

## 2. Множества от същности и техните атрибути

- Изпити - номер тест, заглавие, нужни точки за минаване, научна сфера
- Въпроси - номер въпрос, точки (поне една, с точност до един знак след десетичната запетая, конкретния брой зависи от изпита) 
    - Есе - условие, минимална дължина на отговор, максимална дължина на отговор
    - Затворен въпрос - условие
    - Изчислителен въпрос - условие
- Отговори - номер отговор, текст
- Студенти - факултетен номер, първо име, фамилия, курс, факултет

## 3. Домейн на атрибутите

- Изпити - номер тест : цяло положително число, заглавие: низ, минимални точки за минаване : положително цяло число, максимални точки на изпита, научна сфера: низ
- Въпроси - номер въпрос : цяло положително число, точки: цяло число (по-голямо или равно на 1) 
    - Есе - условие : низ, минимална дължина на отговор: цяло положително число, максимална дължина на отговор: цяло положително число
    - Затворен въпрос - условие : низ,
    - Изчислителен въпрос - условие: низ
- Отговори - номер отговор: цяло положително число, текст: низ
- Студенти - факултетен номер : низ, първо име : низ, фамилия: низ, курс : цяло положително число, факултет : низ

## 4. Връзки
- В един Изпит има много Въпроси. Въпросите участват в много Изпити.
- Всеки Изпит има 0 или 1 нужен Изпит.
- Въпросите имат различни точки във всеки изпит 
    - Есето е Въпрос
    - Затвореният въпрос е Въпрос
    - Изчислителният въпрос е Въпрос
- Един Въпрос има много Отговори. Един Отговор се асоциира само с един Въпрос.
- Студентите могат да се явят на много Изпити. На един Изпит се явяват много Студенти.
- Студентите могат да вземат много Изпити. Един Изпит може да бъде взет от много Студенти.

## 5. Ключове
- Изпити - номер тест : еднозначно определя изпита
- Въпроси - номер въпрос : еднозначно определя въпроса
- Отговори - номер отговор : еднозначно определя въпроса
- Студенти - факултетен номер: еднозначно определя студента

## 6. Правила и проверки
- За изпитите - минимални и максимални точки: точките трябва да са неотрицателни и максималните точки трябва да са повече или равни на минималните
- За въпросите - точки: се прави проверка дали са неотрицателни
- За есетата - минималната дължина и максималната дължина: минималната дължина се прави проверка дали е по-малка или равна от максималната дължина
- За студентите - курс: се прави проверка да е повече от 0
- За взетите изпити - оценка: се прави проверка оценката да е по-голяма или равна на 2

## 7. E/R модел на данни

![E/R](image.png)

## 8. Релационен модел на данни

> Students(fn : char(10), fname : varchar(50), lname : varchar(50), faculty : string(100), course : smallint)

PK: (fn, unique, not null)

CK: (course > 0)

> Exams(nexam : int, title : varchar(255), minpoints : smallint, maxpoints : smallint, science_field : varchar(255), needed_nexam : int) 

PK: (nexam, unique, not null) 

FK: (needed_nexam) 

CK: (minpoints > 0)

CK: (maxpoints>=minpoints)

> TakesExams(fn : char(10), nexam : int, date : date) 

PK: (fn, nexam, unique, not null) 

FK: (fn, nexam)

> TakenExams(fn : char(10), nexam : int, grade : decimal) 

PK: (fn, nexam, unique, not null) 

FK: (fn, nexam) 

CK: (grade >= 2)

> ConsistsOf(nexam : int, nquestion : int, points : decimal) 

PK: (nexam, nquestion , unique, not null) 

FK: (nexam, nquestion ) 

CK: (points > 0)

> Answers(nanswer : int, text : varchar(100), nquestion : int, is_right_answer : char(1)) 

Отговорите са слаби множества 

PK: (nanswer, text, nquestion, unique, not null)

FK: (nquestion) 

CK: (is_right_answer - ‘0’, ‘1’)

Окончателен вариант

> Questions(nquestion : int) 

PK:(nquestion, unique, not null)

> Essays(nquestion : int, condition : varchar(255), min_length : int, max_length : int) 

PK:(nquestion, unique, not null) 

FK:(nquestion) 

CK: (min_length > 0) 

CK: (max_length >= min_length)

> ClosedQuestions(nquestion : int, condition : varchar(255)) 

PK:(nquestion, unique, not null) 

FK:(nquestion)

> CalculationQuestions(nquestion : int, condition : varchar(255)) 

PK:(nquestion, unique, not null) 

FK:(nquestion)

NULL-подход

> Questions(nquestion : int, condition : varchar(255), min_length : int, max_length : int) 

PK:(nquestion, unique, not null) 

CK: (min_length > 0) 

CK: (max_length >= min_length)


## 9. Схема на базата от данни

![alt text](image-1.png)

## 10. Функции

![alt text](image-2.png)

<span style="font-style: italic;">Функция за проверка дали студент е минал даден изпит</span>

![alt text](image-3.png)

<span style="font-style: italic;">Функция за вземане средния успех на студент</span>

## 11. Тригери

![alt text](image-4.png)

<span style="font-style: italic;">Тригер, който проверява дали студента си е взел изпита, преди вмъкване в таблицата за явяване на изпита</span>

![alt text](image-5.png)

<span style="font-style: italic;">Тригер преди обновяване на Изпит с правилния брой максимален брой точки</span>

## 12. Изгледи

![alt text](image-6.png)

![alt text](image-7.png)

![alt text](image-8.png)

![alt text](image-9.png)

![alt text](image-10.png)

![alt text](image-11.png)

![alt text](image-12.png)

## 13. Процедури

![alt text](image-14.png)

<span style="font-style: italic;">Процедура за връщане на общ брой точки на изпит</span>

![alt text](image-13.png)

<span style="font-style: italic;">Процедура за изчисляване на средна оценка на изпит</span>

![alt text](image-15.png)

<span style="font-style: italic;">Процедура за увеличаване точките на отговорите и съответно изпита</span>

![alt text](image-16.png)

<span style="font-style: italic;">Процедура за добавяне на студент</span>

## 14. Приложение за достъп до базата

![alt text](image-17.png)

![alt text](image-18.png)