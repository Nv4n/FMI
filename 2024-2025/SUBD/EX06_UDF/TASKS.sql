SET SCHEMA FN24_3MI0700035;

-- T01
CREATE FUNCTION EMP_AGE(EMP_NO INT)
    RETURNS TABLE
            (
                EMPNO CHAR(6),
                AGE   INT
            )
    SPECIFIC EMP_AGE
    RETURN SELECT EMPNO, YEAR( CURRENT_DATE - BIRTHDATE) AS AGE
           FROM DB2SAMPLE.EMP
           WHERE EMPNO = EMP_NO;



-- T02
CREATE FUNCTION EMP_EXPERIENCE(EMP_NO INT)
    RETURNS TABLE
            (
                EMPNO CHAR(6),
                EXPERIENCE   INT
            )
    SPECIFIC EMP_EXPERIENCE
    RETURN SELECT EMPNO, YEAR( CURRENT_DATE - HIREDATE) AS EXPERIENCE
           FROM DB2SAMPLE.EMP
           WHERE EMPNO = EMP_NO;

SELECT T1.EMPNO,T1.AGE,T2.EXPERIENCE FROM TABLE (FN24_3MI0700035.EMP_AGE('000010')) T1
JOIN TABLE (FN24_3MI0700035.EMP_EXPERIENCE('000010')) T2 ON T1.EMPNO= T2.EMPNO;

